from datetime import date, timedelta
import yfinance as yf
import pandas as pd
from ta import add_all_ta_features
from ta.utils import dropna
from ta.trend import MACD, ADXIndicator
from ta.momentum import RSIIndicator

tickers = ['AKZA.AS', 'AMG.AS', 'DSM.AS', 'IMCD.AS', 'OCI.AS', 'AD.AS', 'ADYEN.AS', 'GLPG.AS', 'GVNV.AS', 'HEIA.AS', 'HEIO.AS', 'PHIA.AS', 'RAND.AS', 'TKWY.AS', 'ABN.AS', 'AGN.AS', 'ASRNL.AS', 'FLOW.AS', 'INGA.AS', 'INTER.AS', 'NN.AS', 'WHA.AS', 'AALB.AS', 'ARCAD.AS', 'BOKA.AS', 'LIGHT.AS', 'PNL.AS', 'TWEKA.AS', 'PRX.AS', 'ASM.AS', 'ASML.AS', 'BESI.AS', 'KPN.AS', 'TOM2.AS', 'VPK.AS', 'SBMO.AS', 'WKL.AS', 'ACX.MC', 'ENC.MC', 'MTS.MC', 'ALM.MC', 'APPS.MC', 'DIA.MC', 'GEST.MC', 'ITX.MC', 'MEL.MC', 'PHM.MC', 'PSG.MC', 'VIS.MC', 'BBVA.MC', 'BKT.MC', 'CABK.MC', 'COL.MC', 'MAP.MC', 'MRL.MC', 'SAB.MC', 'UNI.MC', 'GRF.MC', 'ACS.MC', 'AENA.MC', 'CLNX.MC', 'FCC.MC', 'FER.MC', 'LOG.MC', 'OHLA.MC', 'SCYR.MC', 'SGRE.MC', 'TRE.MC', 'TL5.MC', 'AMS.MC', 'IDR.MC', 'ANA.MC', 'ELE.MC', 'ENG.MC', 'IBE.MC', 'NTGY.MC', 'REE.MC', 'REP.MC', 'ENI.MI', 'TEN.MI', 'AGL.MI', 'CPR.MI', 'JUVE.MI', 'MONC.MI', 'MS.MI', 'SFER.MI', 'STLA.MI', 'TOD.MI', 'AZM.MI', 'BAMI.MI', 'BGN.MI', 'BPE.MI', 'EXO.MI', 'FBK.MI', 'G.MI', 'ISP.MI', 'MB.MI', 'UCG.MI', 'US.MI', 'AMP.MI', 'ATL.MI', 'BRE.MI', 'BZU.MI', 'CNHI.MI', 'IP.MI', 'LDO.MI', 'PRY.MI', 'PST.MI', 'REC.MI', 'UNI.MI', 'DIA.MI', 'PIRC.MI', 'STM.MI', 'A2A.MI', 'ENEL.MI', 'HER.MI', 'IG.MI', 'IRE.MI', 'SRG.MI', 'TIT.MI', 'TRN.MI', 'UMI.BR', 'ABI.BR', 'ARGX.BR', 'COLR.BR', 'UCB.BR', 'AGS.BR', 'GBLB.BR', 'KBC.BR', 'SOF.BR', 'WDP.BR', 'ACKB.BR', 'PROX.BR', 'TNET.BR', 'VWS.CO', 'AMBUB.CO', 'GN.CO', 'PNDORA.CO', 'RBREW.CO', 'JYSK.CO', 'ORSTED.CO', 'TRYG.CO', 'CHR.CO', 'COLO-B.CO', 'DEMANT.CO', 'GMAB.CO', 'LUN.CO', 'NOVO-B.CO', 'NZYM-B.CO', 'DSV.CO', 'FLS.CO', 'ISS.CO', 'MAERSKB.CO', 'ROCKB.CO', 'SIM.CO', 'DANSKE.CO', '1COV.DE', 'BAS.DE', 'BNR.DE', 'EVK.DE', 'GXI.DE', 'LXS.DE', 'NDA.DE', 'NDX1.DE', 'RAA.DE', 'SDF.DE', 'SGL.DE', 'SY1.DE', 'SZG.DE', 'TKA.DE', 'VOE.DE', 'ADS.DE', 'B4B.DE', 'BEI.DE', 'BMW.DE', 'BOSS.DE', 'CEC.DE', 'CON.DE', 'DAI.DE', 'EVD.DE', 'FIE.DE', 'HEN3.DE', 'HFG.DE', 'HLE.DE', 'PAH3.DE', 'PUM.DE', 'RHM.DE', 'SHA.DE', 'SZU.DE', 'VOW3.DE', 'ZAL.DE', 'ZIL2.DE', 'ADJ.DE', 'ALV.DE', 'AOX.DE', 'ARL.DE', 'AT1.DE', 'CBK.DE', 'DB1.DE', 'DEQ.DE', 'DWNI.DE', 'DWS.DE', 'GLJ.DE', 'GYC.DE', 'LEG.DE', 'MUV2.DE', 'PAT.DE', 'TEG.DE', 'TLG.DE', 'VNA.DE', 'WDI.DE', 'AFX.DE', 'BAYN.DE', 'EVT.DE', 'FME.DE', 'FRE.DE', 'MOR.DE', 'QGEN.DE', 'SHL.DE', 'SRT.DE', 'ENR.DE', 'G1A.DE', 'GBF.DE', 'HDD.DE', 'HEI.DE', 'HLAG.DE', 'HOT.DE', '37773.DE', 'OSR.DE', 'S92.DE', 'SIE.DE', 'VAR1.DE', 'WCH.DE', 'DHER.DE', 'DPW.DE', 'FNTN.DE', 'FRA.DE', 'G24.DE', 'HNR1.DE', 'KGX.DE', 'LHA.DE', 'O2D.DE', 'PSM.DE', 'RRTL.DE', 'SAX.DE', 'SIX2.DE', 'TLX.DE', 'UTDI.DE', 'YOU.DE', 'AIXA.DE', 'BC8.DE', 'COP.DE', 'DTE.DE', 'DUE.DE', 'IFX.DE', 'JEN.DE', 'KBX.DE', 'KRN.DE', 'MTX.DE', 'NEM.DE', 'SANT.DE', 'SAP.DE', 'SOW.DE', 'TMV.DE', 'WAF.DE', '1U1.DE', 'ECV.DE', 'EOAN.DE', 'LEO.DE', 'RWE.DE', 'UN01.DE', 'NESTE.HE', 'OUT1V.HE', 'SSABAH.HE', 'UPM.HE', 'KESKOB.HE', 'ORNBV.HE', 'TYRES.HE', 'SAMPO.HE', 'CGCBV.HE', 'HUH1V.HE', 'KCR.HE', 'KNEBV.HE', 'METSB.HE', 'MOCORP.HE', 'NELES.HE', 'VALMT.HE', 'WRT1V.HE', 'NOKIA.HE', 'ELISA.HE', 'FORTUM.HE', '0857.HK', '0386.HK', '3993.HK', '0883.HK', '0968.HK', '1088.HK', '1171.HK', '1898.HK', '2883.HK', '2899.HK', '3800.HK', '0027.HK', '0175.HK', '0322.HK', '0880.HK', '1055.HK', '1093.HK', '1114.HK', '1128.HK', '1177.HK', '1211.HK', '1928.HK', '2020.HK', '2196.HK', '2269.HK', '2313.HK', '2319.HK', '0489.HK', '6862.HK', '0753.HK', '0941.HK', '1044.HK', '1317.HK', '0151.HK', '1530.HK', '1585.HK', '1797.HK', '1801.HK', '1810.HK', '1833.HK', '1873.HK', '1958.HK', '0200.HK', '2238.HK', '2331.HK', '2333.HK', '2338.HK', '0288.HK', '0341.HK', '6055.HK', '6185.HK', '9926.HK', '0011.HK', '0016.HK', '0017.HK', '0388.HK', '0966.HK', '1113.HK', '1336.HK', '2388.HK', '3333.HK', '3908.HK', '6060.HK', '0656.HK', '6837.HK', '0688.HK', '6881.HK', '6886.HK', '0939.HK', '0998.HK', '0101.HK', '1109.HK', '0012.HK', '1288.HK', '1299.HK', '1339.HK', '1359.HK', '1398.HK', '1628.HK', '1966.HK', '1988.HK', '1997.HK', '2007.HK', '2318.HK', '2328.HK', '2601.HK', '2628.HK', '3328.HK', '3968.HK', '3988.HK', '6030.HK', '0778.HK', '0823.HK', '0083.HK', '0066.HK', '0285.HK', '0788.HK', '2018.HK', '2382.HK', '0390.HK', '0914.HK', '1038.HK', '1186.HK', '1618.HK', '1800.HK', '3323.HK', '0669.HK', '0001.HK', '0019.HK', '0763.HK', '3690.HK', '0700.HK', '0728.HK', '0762.HK', '2013.HK', '9618.HK', '9988.HK', 'ANT.HK', '0241.HK', '0268.HK', '0981.HK', '0992.HK', '3888.HK', '0002.HK', '0006.HK', '0135.HK', '0257.HK', '0384.HK', '2386.HK', '2688.HK', '0902.HK', '0916.HK', '1816.HK', '0003.HK', 'JMT', 'BCP', 'EDP', 'AAL.L', 'ANTO.L', 'BHP.L', 'BP.L', 'BWY.L', 'CRDA.L', 'DLN.L', 'DRX.L', 'FRES.L', 'GLEN.L', 'HVPE.L', 'IGG.L', 'JMAT.L', 'LKODL.L', 'LMP.L', 'MNODL.L', 'OCDO.L', 'PFC.L', 'RCP.L', 'RHIM.L', 'RIO.L', 'ROSNL.L', 'RTN.L', 'RWI.L', 'SAGA.L', 'SRP.L', 'SVS.L', 'SVSTL.L', 'TLW.L', 'ABF.L', 'AML.L', 'ATST.L', 'AVV.L', 'BAKK.L', 'BATS.L', 'BBOX.L', 'BGEO.L', 'BOY.L', 'BVIC.L', 'BYG.L', 'CCH.L', 'CCL.L', 'CNE.L', 'CTEC.L', 'CWK.L', 'DGE.L', 'DPH.L', 'DPLM.L', 'DTY.L', 'EQN.L', 'ERM.L', 'ESNT.L', 'FEVR.L', 'FXPO.L', 'GAW.L', 'GFRD.L', 'GFTU.L', 'GOG.L', 'GRG.L', 'GSS.L', 'HFD.L', 'HIK.L', 'HILS.L', 'HSX.L', 'ICP.L', 'IMB.L', 'INDV.L', 'INPP.L', 'IPO.L', 'JD.L', 'JUP.L', 'LRE.L', 'MDC.L', 'MGNTL.L', 'MNDI.L', 'MSLH.L', 'MTO.L', 'NEX.L', 'OSB.L', 'OTB.L', 'PAG.L', 'PAY.L', 'PTEC.L', 'PZC.L', 'RAT.L', 'RDSB.L', 'RDW.L', 'REDD.L', 'RKT.L', 'RNK.L', 'ROO.L', 'ROR.L', 'SDRY.L', 'SHB.L', 'SPI.L', 'SSPG.L', 'SXS.L', 'SYNT.L', 'TATE.L', 'TBCG.L', 'TEM.L', 'TEP.L', 'TIFS.L', 'ULE.L', 'ULVR.L', 'UTG.L', 'WG.L', 'WIZZ.L', '3IN.L', 'ABDN.L', 'ADM.L', 'AGR.L', 'ASCL.L', 'ASHM.L', 'AV.L', 'BAG.L', 'BARC.L', 'BEZ.L', 'BKG.L', 'BLND.L', 'BME.L', 'BWNG.L', 'CARD.L', 'CBG.L', 'CEY.L', 'CINE.L', 'CMCX', 'COA.L', 'CTY.L', 'DGN.L', 'DNLM.L', 'DOM.L', 'ECM.L', 'EMG.L', 'ESKN.L', 'EVR.L', 'FCIT.L', 'FDM.L', 'GNC.L', 'GNS.L', 'GPOR.L', 'HAS.L', 'HICL.L', 'HL.L', 'HMSO.L', 'HOC.L', 'HSBA.L', 'HSV.L', 'HTG.L', 'IBST.L', 'III', 'INCH.L', 'INVP.L', 'IWG.L', 'JDW.L', 'JEO.L', 'JLG.L', 'JUST.L', 'KIE.L', 'LAND.L', 'LGEN.L', 'LLOY.L', 'LSEG.L', 'MAB.L', 'MARS.L', 'MGAM.L', 'MNKS.L', 'MONY.L', 'NOG.L', 'NRR.L', 'NWG.L', 'PAGE.L', 'PFG.L', 'PHP.L', 'PIN.L', 'PLUS', 'PNN.L', 'PRU.L', 'PSH.L', 'QLT.L', 'QQ.L', 'RSW.L', 'SAFE.L', 'SBERL.L', 'SDP.L', 'SDR.L', 'SEQI.L', 'SGC.L', 'SGRO.L', 'SHI.L', 'SMDS.L', 'SMT.L', 'SMWH.L', 'SNN.L', 'STAN.L', 'STJ.L', 'TMPL.L', 'TRIG.L', 'VCT.L', 'VEC.L', 'VOF.L', 'VSVS.L', 'VTY.L', 'WKP.L', 'AZN.L', 'GSK.L', 'SN.L', 'AUTO.L', 'CRST.L', 'CSP.L', 'ELM.L', 'FERG.L', 'GEN.L', 'GRI.L', 'HLMA.L', 'HWDN.L', 'IMI.L', 'MGGT.L', 'MRO.L', 'PETS.L', 'PHNX.L', 'POLY.L', 'PSN.L', 'RR.L', 'SMIN.L', 'SNR.L', 'TCAP.L', 'TPK.L', 'TW.L', 'WEIR.L', 'AHT.L', 'ASC.L', 'BAB.L', 'BDEV.L', 'BNZL.L', 'BRBY.L', 'CPG.L', 'CPI.L', 'DCC.L', 'DLG.L', 'EXPN.L', 'EZJ.L', 'FLTR.L', 'FRAS', 'IAG.L', 'INF.L', 'ITRK.L', 'ITV.L', 'KGF.L', 'MCRO.L', 'MKS.L', 'MRW.L', 'NXT.L', 'PSON.L', 'REL.L', 'RMG.L', 'RTO.L', 'Ryanair', 'SBRY.L', 'SKG.L', 'SPT.L', 'TSCO.L', 'TUI.L', 'VMUK.L', 'WPP.L', 'WTB.L', '0888.L', 'AVST.L', 'BBY.L', 'BT.L', 'CAPC.L', 'CKN.L', 'DMGT.L', 'FSJ.L', 'MTRO.L', 'SCT.L', 'SMSN.L', 'WISE.L', 'ATADL.L', 'BCPT.L', 'BRW.L', 'CCC.L', 'CNA.L', 'DC.L', 'ENT.L', 'FGP.L', 'GLO.L', 'MRC.L', 'NG.L', 'NVTKL.L', 'OGZDL.L', 'PDL.L', 'RMV.L', 'SGGD.L', 'SPX.L', 'SSE.L', 'SVT.L', 'TED.L', 'TRN.L', 'UKCM.L', 'UU.L', 'AMRS', 'ARRY', 'CDXS', 'CLMT', 'DQ', 'FANG', 'LNG', 'PAAS', 'SHLS', 'SSRM', 'STLD', 'FAST', 'IEP', 'WEN', 'AAPL', 'ABMD', 'ACAD', 'ADMP', 'ADVM', 'AFRM', 'AGRX', 'ALDX', 'ALGN', 'ALNY', 'AMED', 'ANDE', 'ARCT', 'ARWR', 'ATHX', 'ATNX', 'ATRA', 'ATRS', 'AVXL', 'AXGN', 'AXSM', 'AY', 'AYRO', 'AYTU', 'BBIO', 'BCRX', 'BILI', 'BLFS', 'BLUE', 'BMRN', 'BNGO', 'BNTX', 'BPMC', 'BRKR', 'CAKE', 'CBRL', 'CDEV', 'CEMI', 'CERS', 'CHEF', 'CHRS', 'CLDX', 'CLNE', 'CLSK', 'CLVS', 'CMCSA', 'CNMD', 'COCP', 'CODX', 'COST', 'CPRT', 'CPRX', 'CRIS', 'CROX', 'CRSP', 'CSGP', 'CVET', 'CYTK', 'CZR', 'DENN', 'DLTR', 'DRVN', 'DVAX', 'DXCM', 'EEFT', 'EVFM', 'EXAS', 'EXEL', 'FATE', 'FCEL', 'FIVE', 'FIZZ', 'FOLD', 'FOSL', 'FROG', 'FRPT', 'FRSX', 'GEVO', 'GH', 'GIII', 'GNOG', 'GO', 'GOSS', 'GPRE', 'GPRO', 'GRWG', 'GT', 'HA', 'HALO', 'HAS', 'HOLX', 'HQY', 'HTBX', 'HTGM', 'HTHT', 'IBRX', 'IDXX', 'IMGN', 'INGN', 'INMD', 'INO', 'IRBT', 'IRTC', 'ISRG', 'ITCI', 'JACK', 'JAGX', 'JOUT', 'KHC', 'KNDI', 'LAZR', 'LI', 'LKQ', 'LULU', 'LXRX', 'MARA', 'MASI', 'MAT', 'MCRB', 'MDLZ', 'MKTX', 'MLCO', 'MNKD', 'MRNA', 'MRTX', 'NAKD', 'NARI', 'NBEV', 'NBIX', 'NEGG', 'NIU', 'NKLA', 'NKTR', 'NNOX', 'NTRA', 'NUVA', 'NUWE', 'NVAX', 'NVCR', 'NWL', 'OCGN', 'OCUL', 'OGI', 'OLLI', 'ORTX', 'OTLY', 'PACB', 'PCAR', 'PDCE', 'PDD', 'PENN', 'PEP', 'PGNY', 'PINC', 'PLAY', 'PLCE', 'PLTK', 'PLUG', 'PLYA', 'PODD', 'POOL', 'PPC', 'PRQR', 'PTEN', 'PTGX', 'PZZA', 'QDEL', 'QLGN', 'QRTEA', 'QURE', 'REGI', 'RETA', 'RGEN', 'RIGL', 'RIOT', 'RPAY', 'RPRX', 'RRGB', 'RRR', 'RUTH', 'RVMD', 'RVNC', 'SABR', 'SAFM', 'SAGE', 'SDC', 'SFM', 'SFT', 'SGMS', 'SINT', 'SKYW', 'SLGN', 'SNDL', 'SNDX', 'SOLO', 'SONO', 'SPWH', 'SPWR', 'SRNE', 'SRPT', 'STNE', 'SUNW', 'SURF', 'SYNH', 'TACO', 'TECH', 'TELL', 'TNDM', 'TOPS', 'TPIC', 'TRVN', 'TSCO', 'TSLA', 'TSP', 'TTCF', 'TTNP', 'TVTY', 'TWOU', 'TXG', 'TXRH', 'UEIC', 'UHAL', 'ULTA', 'UTHR', 'VBIV', 'VC', 'VCYT', 'VIR', 'VLDR', 'VRDN', 'VRM', 'VTRS', 'VXRT', 'WBA', 'WING', 'WKHS', 'WMG', 'WOOF', 'WW', 'ZGNX', 'ABCB', 'AGNC', 'ARCC', 'BGCP', 'BHF', 'CACC', 'CG', 'CINF', 'CME', 'COIN', 'CONE', 'COOP', 'DKNG', 'EHTH', 'EQIX', 'EXPI', 'FITB', 'FUTU', 'GLPI', 'HBAN', 'HOOD', 'IBKR', 'INFO', 'ISBC', 'JFU', 'LAMR', 'MQ', 'NAVI', 'NMIH', 'NTRS', 'NYMT', 'PAYS', 'PBCT', 'PCH', 'PFG', 'PSEC', 'QFIN', 'QIWI', 'RDFN', 'REG', 'ROIC', 'SBNY', 'SBRA', 'SEIC', 'SIVB', 'SLM', 'SNEX', 'SSSS', 'SVC', 'TREE', 'TROW', 'TRUP', 'XP', 'Z', 'ZION', 'AGEN', 'ALVR', 'AMGN', 'BIIB', 'CARA', 'CLOV', 'CRBP', 'CRON', 'CVAC', 'GILD', 'ICPT', 'ILMN', 'INCY', 'IONS', 'JAZZ', 'PBYI', 'PCVX', 'REGN', 'SGEN', 'SGMO', 'TLRY', 'VRTX', 'XRAY', 'ZYNE', 'AAWW', 'ALRM', 'AMBA', 'AVAV', 'AXON', 'BKYI', 'BLDP', 'BLDR', 'BLNK', 'CGNX', 'CLLS', 'COHR', 'CSIQ', 'CTRM', 'CYRX', 'DGLY', 'EDIT', 'EH', 'ENPH', 'FLEX', 'GLBS', 'GLNG', 'GNTX', 'HEAR', 'IIVI', 'ITRI', 'KTOS', 'LECO', 'LFUS', 'LSTR', 'MIDD', 'MRCY', 'MVIS', 'NTDOY', 'NTLA', 'ODFL', 'OLED', 'RUN', 'SAIA', 'SEDG', 'SHIP', 'SRCL', 'SWBI', 'TBLT', 'TTEK', 'WATT', 'AAL', 'ABNB', 'AGC', 'AIHS', 'AMZN', 'ANGI', 'AVT', 'BBBY', 'BKNG', 'BLMN', 'BYND', 'BZUN', 'CAMP', 'CAR', 'CARG', 'CASY', 'CDLX', 'CHDN', 'CHRW', 'CHTR', 'CRNT', 'CRTO', 'CSX', 'CTAS', 'DISCA', 'DISH', 'DNUT', 'EBAY', 'ERIC', 'ETSY', 'EXPD', 'EXPE', 'FFIV', 'FISV', 'FLWS', 'FOXA', 'FTCV', 'FWONA', 'GDS', 'GOGO', 'GOOGL', 'HAIN', 'HMHC', 'HSIC', 'IAC', 'ICLK', 'IDCC', 'IHRT', 'INFN', 'IRDM', 'IZEA', 'JBHT', 'JBLU', 'JOBS', 'LBTYA', 'LBTYK', 'LESL', 'LILA', 'LSXMA', 'LSXMK', 'LUNA', 'LYFT', 'MAR', 'MARK', 'MELI', 'MF', 'MGNI', 'MMYT', 'MNST', 'MTCH', 'NFLX', 'NICE', 'NWSA', 'NXST', 'ODP', 'OKTA', 'ORGN', 'ORLY', 'OSTK', 'PAYO', 'PDCO', 'PRFT', 'PTON', 'PWP', 'REAL', 'ROKU', 'ROST', 'RYAAY', 'SBGI', 'SBUX', 'SFIX', 'SHCR', 'SIRI', 'SOFI', 'SPTN', 'STMP', 'TA', 'TASK', 'TCOM', 'TMUS', 'TRMR', 'TRVG', 'TTD', 'UAL', 'UNIT', 'UONE', 'UPWK', 'URBN', 'VIH', 'VRSK', 'WLTW', 'WYNN', 'ZG', 'ZS', 'ACMR', 'ADBE', 'ADI', 'ADP', 'ADSK', 'AKAM', 'ALGM', 'AMAT', 'AMD', 'AMKR', 'ANSS', 'API', 'APPF', 'APPS', 'ASML', 'ATVI', 'AVGO', 'AVID', 'AZPN', 'BASE', 'BIDU', 'BMBL', 'BOXL', 'BRKS', 'CAN', 'CCMP', 'CDNS', 'CDW', 'CERN', 'CEVA', 'CFLT', 'CHKP', 'CNDT', 'COMM', 'COUP', 'CREE', 'CRSR', 'CRUS', 'CRWD', 'CSCO', 'CSOD', 'CTSH', 'CTXS', 'CYBR', 'DBX', 'DDOG', 'DOCU', 'DOMO', 'DOX', 'EA', 'EGAN', 'ENTG', 'EVBG', 'FB', 'FEYE', 'FSLR', 'FTNT', 'GLBE', 'GNUS', 'GOOG', 'GRMN', 'GSAT', 'HCAT', 'IDEX', 'INPX', 'INTC', 'INTU', 'IPGP', 'JD', 'JKHY', 'KC', 'KLAC', 'KLTR', 'LITE', 'LPSN', 'LRCX', 'LSCC', 'MANH', 'MCHP', 'MDB', 'MITK', 'MKSI', 'MNDY', 'MOMO', 'MPWR', 'MRVL', 'MSFT', 'MSTR', 'MTSI', 'MU', 'NATI', 'NET', 'NLOK', 'NNDM', 'NTAP', 'NTES', 'NTNX', 'NUAN', 'NVDA', 'NXPI', 'OB', 'ON', 'ONEM', 'PAYX', 'PI', 'POSH', 'POWI', 'PTC', 'PUBM', 'PYPL', 'QCOM', 'QRVO', 'QTT', 'RPD', 'SANM', 'SBAC', 'SCPL', 'SIMO', 'SLAB', 'SMTC', 'SNPS', 'SPLK', 'SSNC', 'STX', 'SUMO', 'SWKS', 'SYNA', 'TEAM', 'TER', 'TRIP', 'TRMB', 'TSEM', 'TTWO', 'TXN', 'UI', 'VIAV', 'VISL', 'VOD', 'VRSN', 'VTRU', 'VUZI', 'WB', 'WDAY', 'WDC', 'WIX', 'WKME', 'XLNX', 'XM', 'XNET', 'YNDX', 'ZBRA', 'ZI', 'ZM', 'ZNGA', 'XEL', 'AA', 'AEM', 'AG', 'AGI', 'APA', 'APD', 'ASH', 'AU', 'AUY', 'AXTA', 'BHP', 'BKR', 'BTG', 'CCJ', 'CDE', 'CE', 'CF', 'CLF', 'CLR', 'CMC', 'COG', 'COP', 'CVI', 'CVX', 'DD', 'DK', 'DNOW', 'DVN', 'EGO', 'EMN', 'ENB', 'EOG', 'EPD', 'ET', 'EXK', 'FCX', 'FMC', 'FNV', 'FSM', 'FTI', 'GFI', 'GGB', 'GOLD', 'HAL', 'HES', 'HFC', 'HMY', 'HUN', 'IFF', 'INT', 'IP', 'KGC', 'KL', 'KMI', 'KRO', 'LAC', 'LIN', 'LTHM', 'LYB', 'MAG', 'MOS', 'MRO', 'MUR', 'NEM', 'NOV', 'NUE', 'OLN', 'OVV', 'OXY', 'PAGP', 'PBF', 'PBR', 'PBR', 'PPG', 'PVG', 'PXD', 'RDS', 'RDS', 'RIG', 'RIO', 'RPM', 'RS', 'SBSW', 'SCCO', 'SHW', 'SLB', 'SON', 'SQM', 'SSL', 'SU', 'SUZ', 'SWN', 'SXT', 'TECK', 'TRGP', 'TROX', 'TX', 'VALE', 'VEDL', 'WLK', 'WLL', 'WPM', 'X', 'XEC', 'XOM', 'BYD', 'CC', 'CCU', 'MMM', 'POST', 'SBH', 'SPB', 'ABC', 'ABEV', 'ACI', 'ADM', 'AEO', 'AGRO', 'AM', 'AMC', 'APRN', 'APTV', 'AR', 'ARCH', 'ASXC', 'ATGE', 'AVTR', 'AVY', 'AXL', 'AZN', 'AZUL', 'BC', 'BCO', 'BERY', 'BFAM', 'BG', 'BHVN', 'BIO', 'BJ', 'BKD', 'BLL', 'BOOT', 'BRFS', 'BSX', 'BTI', 'BUD', 'BWA', 'CAG', 'CAH', 'CAL', 'CCEP', 'CCK', 'CCL', 'CGC', 'CHD', 'CHE', 'CHGG', 'CHWY', 'CL', 'CLX', 'CNK', 'CNQ', 'CNX', 'COTY', 'COUR', 'CPA', 'CPB', 'CPE', 'CPRI', 'CRI', 'CRK', 'CRL', 'CTLT', 'CTVA', 'CVE', 'CVNA', 'DAN', 'DBI', 'DECK', 'DEN', 'DG', 'DIN', 'DS', 'EC', 'ECL', 'EDU', 'EFX', 'EHC', 'EL', 'ELAN', 'ELF', 'ENR', 'EPC', 'EQT', 'ETRN', 'EW', 'F', 'FBHS', 'FCN', 'FL', 'FLO', 'FOUR', 'FSR', 'FUN', 'GDOT', 'GEF', 'GIS', 'GKOS', 'GM', 'GMED', 'GOL', 'GPK', 'GPN', 'HAE', 'HBI', 'HEXO', 'HGV', 'HLF', 'HMC', 'HOG', 'HP', 'HRB', 'HRC', 'HRL', 'HSY', 'HYLN', 'IBP', 'IGT', 'IMAX', 'INGR', 'INSP', 'IT', 'JCI', 'JOE', 'K', 'KAR', 'KBH', 'KDMN', 'KDP', 'KMB', 'KO', 'KOS', 'KR', 'LAD', 'LEA', 'LEG', 'LEVI', 'LHX', 'LOW', 'LPI', 'LRN', 'LW', 'M', 'MANU', 'MCK', 'MD', 'MDC', 'MED', 'MGA', 'MGY', 'MHK', 'MKC', 'MO', 'MPLX', 'MSGS', 'MTDR', 'MTH', 'MTN', 'MTOR', 'NBR', 'NCLH', 'NIO', 'NKE', 'NOMD', 'NOVA', 'NS', 'NSP', 'NUS', 'NVO', 'NVRO', 'NVS', 'NVTA', 'OI', 'OSK', 'PAA', 'PAG', 'PBA', 'PEN', 'PFGC', 'PG', 'PII', 'PKG', 'PLNT', 'PM', 'PRG', 'PRTY', 'PUMP', 'PVH', 'QS', 'RACE', 'RAMP', 'RCL', 'RFP', 'RH', 'RL', 'RLX', 'RMD', 'RRC', 'SAM', 'SEAS', 'SEE', 'SHAK', 'SJM', 'SKX', 'SLCA', 'SM', 'SOL', 'SONY', 'SPCE', 'STE', 'STLA', 'STZ', 'SUN', 'TAK', 'TAL', 'TAP', 'TDOC', 'TEVA', 'TFX', 'TGT', 'THO', 'THS', 'TM', 'TMHC', 'TPR', 'TPX', 'TRU', 'TSN', 'TTM', 'TUP', 'U', 'UA', 'UAA', 'USFD', 'UVV', 'VAC', 'VFC', 'VIAC', 'VSTO', 'WEX', 'WGO', 'WH', 'WHR', 'WST', 'WTI', 'XPEV', 'XXII', 'YETI', 'YUMC', 'ZBH', 'ZEPP', 'ZOM', 'AAT', 'ABR', 'ACC', 'ADC', 'ADS', 'AER', 'AFG', 'AFL', 'AIG', 'AIV', 'AIZ', 'AJG', 'AKR', 'ALL', 'ALLY', 'AMG', 'AMH', 'AMP', 'AMT', 'APO', 'ARE', 'ARGO', 'ARR', 'ATH', 'AVB', 'AXP', 'BAC', 'BAM', 'BBD', 'BCS', 'BDN', 'BEN', 'BK', 'BLK', 'BNS', 'BRK', 'BRO', 'BRX', 'BSAC', 'BX', 'BXMT', 'BXP', 'BXS', 'C', 'CADE', 'CB', 'CBRE', 'CCI', 'CFG', 'CIM', 'CIT', 'CM', 'CMA', 'CNO', 'COF', 'COLD', 'COR', 'CPT', 'CUBE', 'CUZ', 'CWK', 'CXP', 'DB', 'DBRG', 'DEI', 'DFS', 'DIDI', 'DLR', 'DOC', 'DRE', 'DRH', 'EGP', 'ELS', 'EPR', 'EPRT', 'EQC', 'EQR', 'ESNT', 'ESRT', 'ESS', 'EXR', 'FAF', 'FBP', 'FCPT', 'FNF', 'FR', 'FRC', 'FRT', 'FSK', 'GEO', 'GL', 'GNL', 'GNW', 'GS', 'HASI', 'HDB', 'HHC', 'HIG', 'HIW', 'HPP', 'HR', 'HSBC', 'HST', 'HTA', 'HTGC', 'IBN', 'IIPR', 'INN', 'INVH', 'IRM', 'IRT', 'ITUB', 'IVR', 'JEF', 'JLL', 'JPM', 'KEY', 'KIM', 'KKR', 'KRC', 'L', 'LAZ', 'LMND', 'LNC', 'LSI', 'LTC', 'LYG', 'MA', 'MAA', 'MAC', 'MAIN', 'MET', 'MFA', 'MFG', 'MGP', 'MKL', 'MMC', 'MMI', 'MPW', 'MS', 'MTB', 'MUFG', 'NLY', 'NNN', 'NRZ', 'NSA', 'O', 'OFC', 'OHI', 'ORI', 'PAGS', 'PDM', 'PEAK', 'PEB', 'PGR', 'PGRE', 'PK', 'PLD', 'PNC', 'PRU', 'PSA', 'PSB', 'QD', 'RDN', 'RE', 'REXR', 'RF', 'RGA', 'RJF', 'RKT', 'RLGY', 'RLJ', 'RMAX', 'RNR', 'RPAI', 'RWT', 'RY', 'RYN', 'SAN', 'SCHW', 'SF', 'SITC', 'SKT', 'SPG', 'SRC', 'SRG', 'STAG', 'STOR', 'STT', 'STWD', 'SUI', 'SYF', 'TD', 'TFC', 'THG', 'TRNO', 'TRV', 'TWO', 'UDR', 'UE', 'UNM', 'USB', 'V', 'VER', 'VICI', 'VNO', 'VTR', 'WELL', 'WFC', 'WPC', 'WRE', 'WU', 'Y', 'A', 'ABBV', 'ABT', 'ACB', 'ANTM', 'BAX', 'BDX', 'BHC', 'BHG', 'BMY', 'CI', 'CNC', 'COO', 'CVS', 'CYH', 'DGX', 'DVA', 'EBS', 'GRA', 'HCA', 'HUM', 'IQV', 'JNJ', 'LH', 'LLY', 'MDT', 'MOH', 'MRK', 'PFE', 'PRGO', 'SMG', 'SYK', 'THC', 'TMO', 'UHS', 'UNH', 'WAT', 'ZTS', 'ADT', 'AGCO', 'AIN', 'AJRD', 'AMCR', 'AME', 'AOS', 'AQUA', 'ATI', 'AYI', 'BA', 'BDC', 'BE', 'BMI', 'BW', 'CARR', 'CAT', 'CFX', 'CHPT', 'CMI', 'CNI', 'CX', 'DAC', 'DAR', 'DCI', 'DE', 'DHI', 'DHR', 'DHT', 'DOV', 'EME', 'EMR', 'ERJ', 'ETN', 'FLR', 'FLS', 'FRO', 'FTAI', 'FTV', 'GD', 'GE', 'GNRC', 'GVA', 'HEI', 'HII', 'HON', 'HUBB', 'HWM', 'HXL', 'IEX', 'ITT', 'ITW', 'JBT', 'KEX', 'KEYS', 'KMT', 'KSU', 'LEN', 'LII', 'LMT', 'LPL', 'LPX', 'MAS', 'MDU', 'MLM', 'MTD', 'MTW', 'MTZ', 'MWA', 'NAT', 'NOC', 'NSC', 'NVR', 'OC', 'OTIS', 'PH', 'PHM', 'PKI', 'PNR', 'PWR', 'RBC', 'ROK', 'ROP', 'RSG', 'RTX', 'RXN', 'SPR', 'STNG', 'SUM', 'SWK', 'TDG', 'TEL', 'TFII', 'TOL', 'TPC', 'TPH', 'TREX', 'TT', 'TXT', 'UAVS', 'UNP', 'UPS', 'VMC', 'WAB', 'WM', 'WRK', 'WY', 'XPO', 'XYL', 'ZIM', 'ZIP', 'ZTO', 'AAP', 'ABG', 'ABM', 'ACM', 'ACN', 'AES', 'ALK', 'ALLE', 'AMWL', 'AN', 'ANET', 'ANF', 'AON', 'ARMK', 'ARW', 'ASAN', 'ATIP', 'ATUS', 'AZO', 'BABA', 'BAH', 'BBWI', 'BBY', 'BIG', 'BURL', 'CIEN', 'CMG', 'DAL', 'DASH', 'DDS', 'DIS', 'DKS', 'DPZ', 'DRI', 'EAT', 'EB', 'EGHT', 'FDS', 'FDX', 'FLT', 'FSLY', 'FUSE', 'FVRR', 'FXLV', 'GHC', 'GLP', 'GME', 'GPC', 'GPI', 'GPS', 'GTN', 'GWW', 'H', 'HD', 'HLT', 'HRI', 'HTZZ', 'HZAC', 'IPG', 'IS', 'J', 'JMIA', 'JWN', 'KBR', 'KMX', 'KNX', 'KSS', 'LCID', 'LUV', 'LVS', 'LYV', 'MAN', 'MAXR', 'MBT', 'MCD', 'MCO', 'MDP', 'MGM', 'MUSA', 'NPTN', 'NSTB', 'NYT', 'OMC', 'OMI', 'OUT', 'PD', 'PLAN', 'POLY', 'QSR', 'QTWO', 'R', 'RAD', 'RHI', 'RNG', 'RRD', 'RSKD', 'RVLV', 'SAH', 'SAVE', 'SCI', 'SIG', 'SIX', 'SKM', 'SMWB', 'SNOW', 'SNX', 'SPGI', 'SQ', 'SQSP', 'SWCH', 'SYY', 'TBLA', 'TGNA', 'TJX', 'TMX', 'TNL', 'TV', 'UBER', 'UNFI', 'URI', 'VIPS', 'W', 'WBT', 'WCC', 'WMT', 'WSM', 'WSO', 'WWE', 'YUM', 'ZH', 'AMX', 'APH', 'ASX', 'ATHM', 'AYX', 'BB', 'BILL', 'BLND', 'BOX', 'BR', 'CAJ', 'CLDR', 'CPNG', 'CRM', 'DBD', 'DDD', 'DELL', 'DOYU', 'DT', 'DXC', 'ENV', 'ESTC', 'FIS', 'FTCH', 'GDDY', 'GIB', 'GLW', 'GOTU', 'GWRE', 'HPE', 'HPQ', 'HUBS', 'IBM', 'INFY', 'JBL', 'JNPR', 'LDOS', 'LUMN', 'MDLA', 'MSCI', 'MSI', 'MX', 'MXL', 'NCR', 'NEWR', 'NLSN', 'NOK', 'NOW', 'ONTO', 'ORCL', 'PANW', 'PATH', 'PAYC', 'PHR', 'PINS', 'PLTR', 'PSTG', 'RBLX', 'RENN', 'S', 'SAIL', 'SE', 'SEMR', 'SHOP', 'SKLZ', 'SMAR', 'SNAP', 'SPOT', 'ST', 'T', 'TDS', 'TEF', 'TEO', 'TME', 'TSM', 'TWLO', 'TWTR', 'UMC', 'VEEV', 'VMW', 'VZ', 'XRX', 'YELP', 'YEXT', 'ZEN', 'ZUO', 'AEE', 'AEP', 'ALB', 'AMRC', 'ATO', 'AWK', 'BIP', 'CIG', 'CMS', 'CNP', 'CVA', 'CWEN', 'D', 'DTE', 'DUK', 'ED', 'EIX', 'ENS', 'ES', 'ETR', 'EVA', 'EVRG', 'EXC', 'FE', 'IDA', 'LNT', 'MPC', 'NEE', 'NEP', 'NI', 'NRG', 'OKE', 'ORA', 'PAM', 'PCG', 'PEG', 'PPL', 'PSX', 'SBS', 'SO', 'SRE', 'UGI', 'VLO', 'VST', 'WEC', 'WES', 'WMB', 'WTRG', 'AKSO.OL', 'DNO.OL', 'PGS.OL', 'PRS.OL', 'SUBC.OL', 'TGS.OL', 'MOWI.OL', 'ORK.OL', 'SALM.OL', 'DNB.OL', 'AKRBP.OL', 'EQNR.OL', 'NEL.OL', 'NHY.OL', 'TOM.OL', 'YAR.OL', 'GJF.OL', 'GOGL.OL', 'NAS.OL', 'SCATC.OL', 'SCHA.OL', 'STB.OL', 'BWLPG.OL', 'TEL.OL', 'AKE.PA', 'SOLB.PA', 'TTE.PA', 'AF.PA', 'BB.PA', 'BIM.PA', 'BN.PA', 'BVI.PA', 'CA.PA', 'CDI.PA', 'CO.PA', 'DBV.PA', 'DIM.PA', 'EDEN.PA', 'ELIOR.PA', 'ELIS.PA', 'EO.PA', 'ERF.PA', 'FDJ.PA', 'FNAC.PA', 'FR.PA', 'GNFT.PA', 'IPN.PA', 'KER.PA', 'MC.PA', 'ML.PA', 'OR.PA', 'ORP.PA', 'POM.PA', 'RCO.PA', 'RI.PA', 'RNO.PA', 'RXL.PA', 'SK.PA', 'SW.PA', 'TRI.PA', 'VIV.PA', 'ACA.PA', 'AED.PA', 'AMUN.PA', 'BNP.PA', 'CNP.PA', 'COFB.PA', 'COV.PA', 'CS.PA', 'ENX.PA', 'GFC.PA', 'GLE.PA', 'ICAD.PA', 'LI.PA', 'MF.PA', 'NXI.PA', 'RF.PA', 'SCR.PA', 'AI.PA', 'EL.PA', 'SAN.PA', 'VLA.PA', 'ADP.PA', 'AKA.PA', 'ALO.PA', 'AM.PA', 'ATE.PA', 'DG.PA', 'EN.PA', 'FGR.PA', 'GET.PA', 'HO.PA', 'LR.PA', 'NK.PA', 'SAF.PA', 'SGO.PA', 'SPIE.PA', 'SU.PA', 'TKTT.PA', 'VK.PA', 'AC.PA', 'AIR.PA', 'BOL.PA', 'DEC.PA', 'ETL.PA', 'FTI.PA', 'MMB.PA', 'MMT.PA', 'ORA.PA', 'PUB.PA', 'RMS', 'SESG.PA', 'ATO.PA', 'CAP.PA', 'CLA.PA', 'DSY.PA', 'PARRO.PA', 'SOP.PA', 'STM.PA', 'TEP.PA', 'UBI.PA', 'WLN.PA', 'EDF.PA', 'ENGI.PA', 'ILD.PA', 'RUI.PA', 'SEV.PA', 'TCH.PA', 'TFI.PA', 'VIE.PA', 'BOL.ST', 'LUNE.ST', 'SAND.ST', 'VOLV-A.ST', 'AAK.ST', 'DOM.ST', 'EKTAB.ST', 'ESSITYB.ST', 'GETIB.ST', 'HM-B.ST', 'ICA.ST', 'KINDSDB.ST', 'LOOMIS.ST', 'SOBI.ST', 'SWMA.ST', 'BALDB.ST', 'CAST.ST', 'FABG.ST', 'INDU-A.ST', 'INVE-A.ST', 'INVEB.ST', 'LUND-B.ST', 'NDA_SE.ST', 'SEB-A.ST', 'SHB-A.ST', 'SWED-A.ST', 'ALFA.ST', 'ASSA-B.ST', 'ATCO-A.ST', 'EPIA.ST', 'HPOLB.ST', 'HUSQB.ST', 'NIBEB.ST', 'SAABB.ST', 'SECU-B.ST', 'SKA-B.ST', 'SKF-A.ST', 'TREL-B.ST', 'TEL2B.ST', 'TELIA.ST', 'EMBRACB.ST', 'ERIC-A.ST', 'HEXA-B.ST', 'SF.ST', 'SAOC', 'CLN.SW', 'DAE.SW', 'EMSN.SW', 'GIVN.SW', 'HOLN.SW', 'OERL.SW', 'UHR.SW', 'ALC.SW', 'BARN.SW', 'DUFN.SW', 'GALE.SW', 'LONN.SW', 'NESN.SW', 'ROG.SW', 'SOON.SW', 'STMN.SW', 'TECN.SW', 'VIFN.SW', 'BAER.SW', 'BALN.SW', 'CFR.SW', 'CMBN.SW', 'CSGN.SW', 'HELN.SW', 'PGHN.SW', 'PSPN.SW', 'SLHN.SW', 'SPSN.SW', 'SREN.SW', 'UBSG.SW', 'ZURN.SW', 'GEBN.SW', 'ABBN.SW', 'BUCN.SW', 'FHZN.SW', 'KNIN.SW', 'LAND.SW', 'SCHP.SW', 'SGSN.SW', 'SIKA.SW', 'SRAIL.SW', 'VACN.SW', 'ADEN.SW', 'DKSH.SW', 'UBXN.SW', 'AMS.SW', 'LOGN.SW', 'SCMN.SW', 'TEMN.SW']
errors = []
alerts = []

end = date.today() - timedelta(365)
#now = date.today()
#print(now.strftime("%a"))

def get_price(ticker):
    try:
        dfWeek = yf.download(ticker, period="2y", interval="1wk")
        dfWeek = dropna(dfWeek)
        macd = MACD(close=dfWeek['Adj Close'])
        adx = ADXIndicator(high=dfWeek['High'], low=dfWeek['Low'], close=dfWeek['Adj Close'])
        dfWeek['histoMACD'] = macd.macd_diff()
        dfWeek['di+'] = adx.adx_pos()

        dfDayly = yf.download(ticker, period="1y", interval="1d")
        dfDayly = dropna(dfDayly)
        rsi = RSIIndicator(close=dfDayly['Adj Close'])
        dfDayly['rsi'] = rsi.rsi()

        if dfWeek['di+'][-2] > dfWeek['di+'][-3]:
            if (dfWeek['histoMACD'][-2] < 0):
                if (dfWeek['histoMACD'][-2] > dfWeek['histoMACD'][-3]):
                    if (dfDayly['rsi'][-1] < 70):
                        alerts.append(ticker)

        print(alerts)
    except Exception:
        errors.append(ticker)
        print(errors)

for ticker in tickers:
    try:
        get_price(ticker)
    except Exception:
        print("Error")
        continue

